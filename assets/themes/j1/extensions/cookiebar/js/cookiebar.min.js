/*
 # -----------------------------------------------------------------------------
 #  ~/extensions/cookiebar/js/cookiebar.min.js
 #  Provides Javascript functions for jQuery cookiebar
 #
 #  Product/Info:
 #  http://jekyll.one
 #  http://www.primebox.co.uk/projects/jquery-cookiebar/
 #
 #  Copyright (C) 2019 Juergen Adams
 #  Copyright (C) 2016 Ant Parsons (primebox.co.uk)
 #
 #  J1 Template is licensed under the MIT License.
 #  See: https://github.com/jekyll-one/j1_template/blob/master/LICENSE
 #  cookiebar is licensed under Creative Commons Attribution 3.0 Unported License.
 #  See: http://creativecommons.org/licenses/by/3.0/
 #
 # -----------------------------------------------------------------------------
*/  
module.exports=(function(a){a.cookieBar=function(e,A){if(e=="cookies"){var y="cookies"}else{if(e=="set"){var y="set"}else{var y=false}}var m={message:"We use cookies to track usage and preferences.",acceptButton:true,acceptText:"I Understand",acceptFunction:function(i){if(i!="enabled"&&i!="accepted"){window.location=window.location.href}},declineButton:false,declineText:"Disable Cookies",declineFunction:function(i){if(i=="enabled"||i=="accepted"){window.location=window.location.href}},policyButton:false,policyText:"Privacy Policy",policyURL:"/privacy-policy/",autoEnable:true,acceptOnContinue:false,acceptOnScroll:false,acceptAnyClick:false,expireDays:365,renewOnVisit:false,forceShow:false,effect:"slide",element:"body",append:false,fixed:false,bottom:false,zindex:"",domain:String(window.location.hostname),referrer:String(document.referrer)};var e=a.extend(m,e);var z=log4javascript.getLogger("j1.Cookiebar");var p={};user_state_detected=j1.existsCookie("j1.user.state");if(user_state_detected){z.info("User state cookie found");p=j1.getUserState()}else{z.error("User state NOT cookie found")}var q=new Date();q.setTime(q.getTime()+(e.expireDays*86400000));q=q.toGMTString();var t="cb-enabled={value}; expires="+q+"; path=/";var v,k="",o,s=document.cookie.split("; ");for(v=0;v<s.length;v++){o=s[v].split("=");if(o[0]=="cb-enabled"){k=o[1]}else{k=typeof p.cookies_accepted=="undefined"?"":p.cookies_accepted}}if(k==""&&y!="cookies"&&e.autoEnable){k="enabled"}else{if((k=="accepted"||k=="declined")&&y!="cookies"&&e.renewOnVisit){}}p.cookies_accepted=k;j1.setUserState(p);if(e.acceptOnContinue){if(e.referrer.indexOf(e.domain)>=0&&String(window.location.href).indexOf(e.policyURL)==-1&&y!="cookies"&&y!="set"&&k!="accepted"&&k!="declined"){y="set";A="accepted"}}if(y=="cookies"){if(k=="enabled"||k=="accepted"){return true}else{return false}}else{if(y=="set"&&(A=="accepted"||A=="declined")){p.cookies_accepted=A;j1.setUserState(p);if(A=="accepted"){return true}else{return false}}else{var n=e.message.replace("{policy_url}",e.policyURL);if(e.acceptButton){var h='<a href="" class="cb-enable">'+e.acceptText+"</a>"}else{var h=""}if(e.declineButton){var w='<a href="" class="cb-disable">'+e.declineText+"</a>"}else{var w=""}if(e.policyButton){var j='<a href="'+e.policyURL+'" class="cb-policy">'+e.policyText+"</a>"}else{var j=""}if(e.fixed){if(e.bottom){var g=' class="fixed bottom"'}else{var g=' class="fixed"'}}else{var g=""}if(e.zindex!=""){var l=' style="z-index:'+e.zindex+';"'}else{var l=""}if(e.forceShow||k=="enabled"||k==""){if(e.append){a(e.element).append('<div id="cookie-bar"'+g+l+"><p>"+n+h+w+j+"</p></div>");if(e.stopScrolling){a("body").addClass("stop-scrolling")}}else{a(e.element).prepend('<div id="cookie-bar"'+g+l+"><p>"+n+h+w+j+"</p></div>");if(e.stopScrolling){a("body").addClass("stop-scrolling")}}}var x=function(i){if(e.acceptOnScroll){a(document).off("scroll")}if(typeof(i)==="function"){i(k)}if(e.effect=="slide"){a("#cookie-bar").slideUp(300,function(){a("#cookie-bar").remove()});if(e.stopScrolling){a("body").removeClass("stop-scrolling")}}else{if(e.effect=="fade"){a("#cookie-bar").fadeOut(300,function(){a("#cookie-bar").remove()});if(e.stopScrolling){a("body").removeClass("stop-scrolling")}}else{a("#cookie-bar").hide(0,function(){a("#cookie-bar").remove()});if(e.stopScrolling){a("body").removeClass("stop-scrolling")}}}a(document).unbind("click",r)};var u=function(){p.cookies_accepted="accepted";j1.setUserState(p);x(e.acceptFunction)};var d=function(){var i=new Date();i.setTime(i.getTime()-(864000000));i=i.toGMTString();s=document.cookie.split("; ");for(v=0;v<s.length;v++){o=s[v].split("=");if(o[0].indexOf("_")>=0){}else{}}x(e.declineFunction)};var r=function(i){if(!a(i.target).hasClass("cb-policy")){u()}};a("#cookie-bar .cb-enable").click(function(){u();return false});a("#cookie-bar .cb-disable").click(function(){d();return false});if(e.acceptOnScroll){var c=a(document).scrollTop(),f,b;a(document).on("scroll",function(){f=a(document).scrollTop();if(f>c){b=f-c}else{b=c-f}if(b>=Math.round(e.acceptOnScroll)){u()}})}if(e.acceptAnyClick){a(document).bind("click",r)}}}}})(jQuery);