/*
 # -----------------------------------------------------------------------------
 # ~/assets/themes/j1/modules/twemoji/js/picker/twemoji-picker.min.js
 # Twemoji-Picker v2017-06-03 implementation for J1 template
 #
 # Product/Info:
 # https://jekyll.one
 # https://github.com/xLs51/Twemoji-Picker
 #
 # Copyright (C) 2021 Juergen Adams
 # Copyright (C) 2015 xLs51
 #
 # J1 Template is licensed under the MIT License.
 # See: https://github.com/jekyll-one-org/J1 Template/blob/master/LICENSE
 # Twemoji-Picker is licensed under under the MIT License.
 # For details, https://github.com/xLs51/Twemoji-Picker
 # -----------------------------------------------------------------------------
*/
(function(l,n,j){var h=150;var m={};var i="/assets/data/twa_v1.json";l.TwemojiPicker=function(a,b){var c=this;l.when(c._loadDatabase()).done(function(d){c.$el=l(a);c._init(b)})};l.TwemojiPicker.defaults={init:null,size:25,icon:"grinning",iconSize:25,height:100,width:null,category:["smile","cherry-blossom","video-game","oncoming-automobile","symbols"],categorySize:20,pickerPosition:null,pickerHeight:150,pickerWidth:null,placeholder:"",};l.TwemojiPicker.prototype={_init:function(a){this.options=l.extend(true,{},l.TwemojiPicker.defaults,a);this._initPicker();this._initCategory();this._initTwemoji();this._initText();this._initStyle();this._initEvents()},_loadDatabase:function k(){return l.ajax({url:i,success:function(a){if(typeof a=="string"){m=JSON.parse(a)}if(typeof a=="object"){m=a}}})},_initPicker:function(){var a=this;a.$id="#"+a.$el["0"].id;a.$pickerHeigth=a.options.height.replace("px","");a.$pickerHeigth=Number(a.$pickerHeigth);a.$wrapper=a.$el.wrap('<div class="twemoji-wrap"></div>').parent();a.$wrapper.append('<div class="twemoji-textarea" contentEditable="true" placeholder="'+a.options.placeholder+'"></div>');a.$wrapper.append('<div class="twemoji-textarea-duplicate"></div>');a.$wrapper.append('<div class="twemoji-icon-picker"> <span id="open-group" class="mr-2"><button type="button" name="open-group" class="btn btn-raised btn-flex btn-info mr-2"><i class="toggle-button mdi mdi-lg mr-1 mdi-toggle-switch-off"></i> Picker </button></span><span id="clear-textarea"><button type="button" name="clear-textarea" class="btn btn-raised btn-flex btn-secondary"><i class="mdi mdi-sticker-emoji mdi-lg mr-1"></i> Clear </button></span></div>');a.$wrapper.append('<div class="twemoji-picker"></div>');a.$el.hide();a.$textarea=a.$wrapper.find(".twemoji-textarea");a.$textareaDuplicate=a.$wrapper.find(".twemoji-textarea-duplicate").hide();a.$iconPicker=a.$wrapper.find("#open-group");a.$clearTextarea=a.$wrapper.find("#clear-textarea");a.$picker=a.$wrapper.find(".twemoji-picker").hide()},_initCategory:function(){var b=this;var a=this.options.category;this.categoryName=["people","nature","object","place","symbol"];this.$picker.append('<div class="twemoji-picker-category"></div>');this.$pickerCategory=this.$picker.find(".twemoji-picker-category");l.each(this.categoryName,function(d,c){b.$pickerCategory.append('<span data-category="'+c+'">'+b.imageFromName(a[d])+"</span>")});this.$pickerCategory.find("span:first").addClass("active")},_initTwemoji:function(){var a=this;l.each(this.categoryName,function(c,b){a.$picker.append('<div class="twemoji-list '+b+'"></div>');l.each(m,function(e,d){if(d.category===b){a.$wrapper.find(".twemoji-picker ."+b).append('<span><img class="emoji" draggable="false" src="'+d.base64+'" alt="'+d.value+'" title="'+d.name+'"></span>')}})});this.$twemojiList=this.$picker.find(".twemoji-list");this.$twemojiList.not(":first").hide()},_initText:function(){if(this.options.init){var a=this.options.init;var b=/:([\w-]+):/g;var c;while(c==b.exec(a)){a=a.replace(c[0],this.imageFromName(c[1],true))}this.$textarea.html(a);this.copyTextArea(this.$textarea.html())}},_initStyle:function(){this.$wrapper.css({width:this.options.width?this.options.width:"100%",height:this.options.height?this.options.height:"",});this.$wrapper.find("img").css({width:this.options.size,height:this.options.size,});this.$iconPicker.css({width:this.options.iconSize,height:this.options.iconSize,});this.$pickerCategory.find("img").css({width:this.options.categorySize,height:this.options.categorySize,});this.$twemojiList.css({width:this.options.pickerWidth?this.options.pickerWidth:"100%",height:this.options.pickerHeight,});this.$picker.css({width:this.options.pickerWidth?this.options.pickerWidth:"100%",top:this.options.pickerPosition==="top"?"-"+this.$picker.outerHeight()+"px":"",})},_initEvents:function(){var a=this;this.$textarea.on("keyup",function(){a.copyTextArea(l(this).html())});this.$iconPicker.on("click",function(){var b=l(".twemoji-picker").height()+h;l("#picker").height(b);l(".toggle-button").toggleClass("mdi-toggle-switch-off mdi-toggle-switch");if(!a.openedPicker){a.openPicker()}else{a.closePicker();l("#picker").height(a.$pickerHeigth)}});this.$clearTextarea.on("click",function(){a.copyTextArea("");l(a.$id).val("");l(".twemoji-textarea > .emoji-span").remove()});this.$pickerCategory.find("span").on("click",function(){var b=l(this).data("category");a.openCategory(l(this),b)});this.$pickerCategory.find(".close").on("click",function(){if(a.openedPicker){a.closePicker()}});this.$twemojiList.find("img").on("click",function(){a.copyTwemoji(l(this))})},copyText:function(a){var b=document.createElement("textarea");b.setAttribute("style","position:fixed;opacity:0;top:100px;left:100px");b.value=a;document.body.appendChild(b);b.select();document.execCommand("copy");var c=document.createElement("div");c.setAttribute("class","copied");c.appendChild(document.createTextNode("Copied to Clipboard"));document.body.appendChild(c);setTimeout(function(){document.body.removeChild(b);document.body.removeChild(c)},1500)},openPicker:function(){this.$picker.show();this.openedPicker=true},closePicker:function(){this.$picker.hide();this.openedPicker=false},openCategory:function(b,a){this.$pickerCategory.find("span").removeClass("active");b.addClass("active");this.$twemojiList.not(".twemoji-picker ."+a).hide();this.$twemojiList.filter(".twemoji-picker ."+a).show()},copyTwemoji:function(a){var d=a.attr("alt");var b=a.attr("src");var c=a.attr("title");var e="emoji:"+c+"[]";this.copyText(e);this.$textarea.focus();this.pasteAtCursor('<span class="emoji-span"><img class="emoji" src="'+b+'" title="'+c+'" alt="'+d+'" width="'+this.options.size+'" height="'+this.options.size+'"> '+e+"</span> ");this.copyTextArea(this.$textarea.html())},copyTextArea:function(a){var c=this.$textareaDuplicate.html(a);c.find("img").replaceWith(function(){return this.alt});var b=c.html();this.$el.text(b)},imageFromName:function(b,a){var c=l.grep(m,function(d){return d.name==b});if(a){return'<img class="emoji" src="'+c[0].base64+'" alt="'+c[0].value+'" width="'+this.options.size+'" height="'+this.options.size+'">'}return'<img class="emoji" draggable="false" src="'+c[0].base64+'" alt="'+b+'">'},pasteAtCursor:function(a){var b,f;if(n.getSelection){b=n.getSelection();if(b.getRangeAt&&b.rangeCount){f=b.getRangeAt(0);f.deleteContents();var e=document.createElement("div");e.innerHTML=a;var g=document.createDocumentFragment(),c,d;while((c=e.firstChild)){d=g.appendChild(c)}f.insertNode(g);if(d){f=f.cloneRange();f.setStartAfter(d);f.collapse(true);b.removeAllRanges();b.addRange(f)}}}else{if(document.selection&&document.selection.type!="Control"){document.selection.createRange().pasteHTML(a)}}}};l.fn.twemojiPicker=function(a){var b=l.data(this,"twemojiPicker");this.each(function(){b?b._init():b=l.data(this,"twemojiPicker",new l.TwemojiPicker(this,a))});return b}})(jQuery,window);
